

<!-- Path to wiki directories, without backslash -->

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Omnibus F4 Pro (on-board current sensor) and Omnibus F4 AIO (no sensor onboard) &mdash; Copter  documentation</title>
  

  <!-- favicon -->
  
  
    <link rel="shortcut icon" href="../_static/favicon_copter.ico"/>
  
  <!-- favicon end -->
  
  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/common_theme_override.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="Copter  documentation" href="../index.html"/>
        <link rel="up" title="Autopilot Hardware Options" href="common-autopilots.html"/>
        <link rel="next" title="Omnibus F4 Nano V6 and V6.x" href="common-omnibusnanov6.html"/>
        <link rel="prev" title="mRo Nexus" href="common-mro-nexus.html"/>  
  <script type="text/javascript">
  window.liveSettings = {
    api_key: "53747d3f35bf4cec9372629094cd9fe2",
    picker: "bottom-right",
    detectlang: true,
    autocollect: true,
    dynamic: false
  };
  </script>


  
  <script src="../_static/js/modernizr.min.js"></script>

</head>



<body class="wy-body-for-nav" role="document">

        
    <div id='cssmenu'>
        <ul>
           <li><a href='/ardupilot/index.html'>Home</a>
              <ul>
                 <li><a href='/copter/index.html'>Copter</a></li>
                 <li><a href='/plane/index.html'>Plane</a></li>
                 <li><a href='/rover/index.html'>Rover</a></li>
                 <li><a href='http://ardusub.com/'>Sub</a></li>
                 <li><a href='/antennatracker/index.html'>AntennaTracker</a></li>
                 <li><a href='/planner/index.html'>Mission Planner</a></li>
                 <li><a href='/planner2/index.html'>APM Planner 2</a></li>
                 <li><a href='/mavproxy/index.html'>MAVProxy</a></li>
                 <li><a href='/dev/docs/companion-computers.html'>Companion Computers</a></li>
                 <li><a href='/dev/index.html'>Developer</a></li>
              </ul>
           </li>
           
          
           
           <li><a href='https://firmware.ardupilot.org/'>Downloads</a>
              <ul>
                <li><a href='https://firmware.ardupilot.org/Tools/MissionPlanner/'>Mission Planner</a></li>
                <li><a href='https://firmware.ardupilot.org/Tools/APMPlanner/'>APM Planner 2</a></li>
                   <li><a title="Advanced User Tools" href="common-downloads_advanced_user_tools.html">Advanced User Tools</a></li>
                   <li><a title="Developer Tools" href="common-downloads_developer_tools.html">Developer Tools</a></li>
                   <li><a title="Firmware" href="common-downloads_firmware.html">Firmware</a></li>
                </ul>
           </li>
           
           <li><a href='https://discuss.ardupilot.org' />Community</a>
              <ul>
                 <li><a href='https://discuss.ardupilot.org/'>Support Forums</a></li>
                 <li><a href='https://www.facebook.com/groups/ArduPilot.org'>Facebook</a></li>
                 <li><a href='https://ardupilot.org/discord'>Developer Chat (Discord)</a></li>
                 <li><a href='https://ardupilot.org/discord'>Developer Voice (Discord)</a></li>
				 <li><a href='https://ardupilot.org/dev/docs/common-contact-us.html'>Contact us</a></li>
				 <li><a href='https://ardupilot.org/dev/index.html#getting-involved'>Getting involved</a></li>
                   <li><a title="Commercial Support" href="common-commercial-support.html">Commercial Support</a></li>
                   <li><a title="Dev Team" href="common-team.html">Development Team</a></li>
                   <li><a title="Training Centers" href="common-training-centers.html">UAS Training Centers</a></li>
              </ul>
           </li>
             <li><a title="Stores" href="common-stores.html">Stores</a></li>


             <li><a title="SWAG Shop" href="https://shop.ardupilot.org">SWAG</a></li>

           
           
                        <li><a title="About" href="../index.html">About</a>
               <ul>
                   <li><a title="Project News" href="project-news.html">News</a></li>
                   <li><a title="History of ArduPilot" href="common-history-of-ardupilot.html">History</a></li>
                   <li><a href='https://ardupilot.org/dev/docs/license-gplv3.html'>License</a></li>
                   <li><a href='https://ardupilot.org/dev/docs/trademark.html'>Trademark</a></li>
                   <li><a title="Acknowledgments" href="common-acknowledgments.html">Acknowledgments</a></li>
                   <li><a title="Wiki Editing Guide" href="common-wiki_editing_guide.html">Wiki Editing Guide</a></li>
               </ul>
             </li>
        </ul>
        
<style>
#jdlogo {
  top: 10px;
  right: 20px;
  position: absolute;
  color: #dddddd;
}
#jdlogo a:visited,
#jdlogo a:link {
  color: #9B59B6;
}
#jdlogo a:hover,
#jdlogo a:active {
  color: #CACACA;
}
</style>

</div>

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        
          <a href="../index.html" class="icon icon-home"> Copter
        

        
          
          <img src="../_static/ardupilot_logo.png" class="logo" />
        
        </a>

        
          
          
        

        
          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        
        
        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introducing Copter</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="common-autopilots.html">AutoPilot Hardware Options</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="common-autopilots.html#open-hardware">Open hardware</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="common-autopilots.html#closed-hardware">Closed hardware</a><ul class="current">
<li class="toctree-l3"><a class="reference external" href="https://aerotenna.com/shop/ocpoc-zynq-mini/">Aerotenna Ocpoc-Zynq</a></li>
<li class="toctree-l3"><a class="reference internal" href="common-navio2-overview.html">Emlid NAVIO2 (Linux)</a></li>
<li class="toctree-l3"><a class="reference internal" href="common-furiousfpv-f35.html">Furious FPV F-35 Lightning and Wing FC-10</a></li>
<li class="toctree-l3"><a class="reference internal" href="common-durandal-overview.html">Holybro Durandal H7</a></li>
<li class="toctree-l3"><a class="reference internal" href="common-holybro-kakutef4.html">Holybro Kakute F4</a></li>
<li class="toctree-l3"><a class="reference internal" href="common-holybro-kakutef7aio.html">Holybro Kakute F7 AIO*</a></li>
<li class="toctree-l3"><a class="reference internal" href="common-holybro-kakutef7mini.html">Holybro Kakute F7 Mini* (only V1 and V2 are compatible)</a></li>
<li class="toctree-l3"><a class="reference external" href="https://github.com/ArduPilot/ardupilot/blob/master/libraries/AP_HAL_ChibiOS/hwdef/Pixhawk4/README.md">Holybro Pixhawk 4</a></li>
<li class="toctree-l3"><a class="reference external" href="https://github.com/ArduPilot/ardupilot/blob/master/libraries/AP_HAL_ChibiOS/hwdef/PH4-mini/README.md">Holybro Pixhawk 4 Mini</a></li>
<li class="toctree-l3"><a class="reference internal" href="common-matekf405-se.html">Mateksys F405-SE</a></li>
<li class="toctree-l3"><a class="reference internal" href="common-matekf405.html">Mateksys F405-STD and variants*</a></li>
<li class="toctree-l3"><a class="reference internal" href="common-matekf405-wing.html">Mateksys F405-Wing*</a></li>
<li class="toctree-l3"><a class="reference internal" href="common-matekf765-wing.html">Mateksys F765-Wing</a></li>
<li class="toctree-l3"><a class="reference internal" href="common-matekh743-wing.html">Mateksys H743-Wing</a></li>
<li class="toctree-l3"><a class="reference internal" href="common-mro-control-zero-F7.html">mRo ControlZero F7</a></li>
<li class="toctree-l3"><a class="reference internal" href="common-pixracer-pro.html">mRo Pixracer Pro (H7)</a></li>
<li class="toctree-l3"><a class="reference internal" href="common-mro-nexus.html">mRo Nexus</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Omnibus F4 AIO/Pro*</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#specifications">Specifications</a></li>
<li class="toctree-l4"><a class="reference internal" href="#where-to-buy">Where to Buy</a></li>
<li class="toctree-l4"><a class="reference internal" href="#versions">Versions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#board-connections">Board Connections</a></li>
<li class="toctree-l4"><a class="reference internal" href="#pwm-outputs">PWM Outputs</a></li>
<li class="toctree-l4"><a class="reference internal" href="#default-uart-order">Default UART order</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dshot-capability">Dshot capability</a></li>
<li class="toctree-l4"><a class="reference internal" href="#flashing-firmware">Flashing Firmware</a></li>
<li class="toctree-l4"><a class="reference internal" href="#how-to-trigger-a-camera-with-relay-pin">How to trigger a camera with relay pin</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="common-omnibusnanov6.html">OmnibusNanoV6</a></li>
<li class="toctree-l3"><a class="reference internal" href="common-omnibusf7.html">Omnibus F7V2*</a></li>
<li class="toctree-l3"><a class="reference internal" href="parrot-bebop-autopilot.html">Parrot Bebop Autopilot</a></li>
<li class="toctree-l3"><a class="reference internal" href="common-CHUCK-overview.html">Parrot C.H.U.C.K</a></li>
<li class="toctree-l3"><a class="reference internal" href="common-radiolink-minipix.html">RadioLink MiniPix</a></li>
<li class="toctree-l3"><a class="reference internal" href="common-qiotek-zealot.html">QioTek Zealot F427</a></li>
<li class="toctree-l3"><a class="reference internal" href="common-speedybeef4.html">SpeedyBee F4 (this board currently is non-verified)</a></li>
<li class="toctree-l3"><a class="reference external" href="http://www.virtualrobotix.it/index.php/en/shop/autopilot/vrbrain5-detail">VR Brain 5</a></li>
<li class="toctree-l3"><a class="reference external" href="http://www.virtualrobotix.it/index.php/en/shop/autopilot/vrbrainmicro51-detail">VR uBrain 5.1</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="common-autopilots.html#firmware-limitations">Firmware Limitations</a></li>
<li class="toctree-l2"><a class="reference internal" href="common-autopilots.html#discontinued-boards">Discontinued boards</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="initial-setup.html">First Time Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="flying-arducopter.html">First Flight</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-when-problems-arise.html">If A Problem Arises</a></li>
<li class="toctree-l1"><a class="reference internal" href="copter-flight-features.html">Flight Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-advanced-configuration.html">Advanced Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-mission-planning.html">Mission Planning</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-logs.html">Logs</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-optional-hardware.html">Peripheral Hardware</a></li>
<li class="toctree-l1"><a class="reference internal" href="traditional-helicopters.html">Traditional Helicopters</a></li>
<li class="toctree-l1"><a class="reference internal" href="tricopter.html">Tricopter</a></li>
<li class="toctree-l1"><a class="reference internal" href="singlecopter-and-coaxcopter.html">SingleCopter and CoaxCopter</a></li>
<li class="toctree-l1"><a class="reference internal" href="heliquads.html">HeliQuads</a></li>
<li class="toctree-l1"><a class="reference internal" href="skyrocket.html">SkyRocket</a></li>
<li class="toctree-l1"><a class="reference internal" href="solo_arducopter_upgrade.html">Solo</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference-frames.html">Reference Frames</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-use-cases-and-applications.html">Use-Cases and Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-antenna-tracking.html">Antenna Tracking</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-simulation.html">Simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-master-features.html">Upcoming Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-user-alerts.html">User Alerts</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-appendix.html">Appendix</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-table-of-contents.html">Full Table of Contents</a></li>
</ul>

          
        
        
        <!-- add paypal and dronecode logos -->
                <div style="margin: auto; padding-left:20px; padding-right:20px; width=100%">

        <hr />
        <form style="margin:auto;" action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
        <input type="hidden" name="cmd" value="_s-xclick" />
        <input type="hidden" name="hosted_button_id" value="BBF28AFAD58B2" />
        <input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_donate_LG.gif" border="0" name="submit" title="PayPal - The safer, easier way to pay online!" alt="Donate" />
        </form>
        <br>
        <a href="common-donation.html">Individual</a>
        <a href="common-partners.html">Partners</a>
        <a href="https://shop.ardupilot.org">SWAG Shop</a>

        <hr />
        </div>
        <!-- endadd paypal and dronecode logos -->
              
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">Copter</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



 
 
 
 
 
  
   
 

<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="common-autopilots.html">Autopilot Hardware Options</a> &raquo;</li>
      
    <li>Omnibus F4 Pro (on-board current sensor) and Omnibus F4 AIO (no sensor onboard)</li>
      <li class="wy-breadcrumbs-aside">
                
          
            <a href="https://github.com/ArduPilot/ardupilot_wiki/blob/master/common/source/docs/common-omnibusf4pro.rst" class="fa fa-github"> Edit on GitHub</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="omnibus-f4-pro-on-board-current-sensor-and-omnibus-f4-aio-no-sensor-onboard">
<span id="common-omnibusf4pro"></span><h1>Omnibus F4 Pro (on-board current sensor) and Omnibus F4 AIO (no sensor onboard)<a class="headerlink" href="#omnibus-f4-pro-on-board-current-sensor-and-omnibus-f4-aio-no-sensor-onboard" title="Permalink to this headline">¶</a></h1>
<div class="figure" id="id1">
<a class="reference external image-reference" href="../_images/omnibusf4pro.png"><img alt="../_images/omnibusf4pro.png" src="../_images/omnibusf4pro.png" style="width: 450px;" /></a>
<p class="caption"><span class="caption-text">Above image and some content courtesy of <a class="reference external" href="https://store.myairbot.com/flight-controller/omnibus-f3-f4/omnibusf4prov3.html">myairbot.com</a></span></p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Support for this board is available with Copter-3.6.0 and Plane-3.9.0 (and higher)</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Due to flash memory limitations, this board does not include all ArduPilot features.
See <a class="reference internal" href="common-limited-firmware.html#common-limited-firmware"><span class="std std-ref">Firmware Limitations</span></a> for details.</p>
</div>
<div class="section" id="specifications">
<h2>Specifications<a class="headerlink" href="#specifications" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><strong>Processor</strong><ul>
<li>STM32F405 ARM</li>
</ul>
</li>
<li><strong>Sensors</strong><ul>
<li>InvenSense MPU6000 IMU (accel, gyro)</li>
<li>BMP280 barometer</li>
<li>Voltage and current (only Pro version) sensors</li>
</ul>
</li>
<li><strong>Interfaces</strong><ul>
<li>UARTS</li>
<li>6 or 8 PWM (Pro only) outputs</li>
<li>RC input PWM/PPM, SBUS</li>
<li>I2C port for external compass</li>
<li>USB port</li>
<li>Built-in OSD</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="where-to-buy">
<h2>Where to Buy<a class="headerlink" href="#where-to-buy" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>available from multiple retailers including <a class="reference external" href="https://store.myairbot.com/flight-controller/omnibus-f3-f4/omnibusf4prov3.html">myairbot.com</a></li>
</ul>
</div>
<div class="section" id="versions">
<h2>Versions<a class="headerlink" href="#versions" title="Permalink to this headline">¶</a></h2>
<p>There have been many versions of this board and many clones. Best results, with no feature/performance impacts will be obtained boards which have solder jumpers for selecting “SBUS” or “PPM” RX input. This should be soldered to the “PPM” selection for ALL reciever types. ArduPilot will automatically detect and accept any supported format (SBUS/PPM/DSM/etc.) on the RX input with this jumper selection. In addition, be sure the board has a barometer, SD Card slot, and Current sense circuit.</p>
</div>
<div class="section" id="board-connections">
<h2>Board Connections<a class="headerlink" href="#board-connections" title="Permalink to this headline">¶</a></h2>
<p>GPS is attached to UART6 (SERIAL3)</p>
<p>Telem is available at UART 1 (SERIAL1)</p>
<p>The shared USART3/I2C pins are ,by default, enabled only for I2C operation to allow external compass or digital airspeed sensor attachment.If at least one device attached externally, does not have pull-up resistors, then 2K ohm pull-up resistors will need to be added externally.</p>
<p>However, by setting <a class="reference internal" href="parameters.html#brd-alt-config"><span class="std std-ref">BRD_ALT_CONFIG</span></a> to 1, the external I2C connection is disabled, so that USART3 may be used as a normal UART. It is SERIAL2 in the parameters listings.</p>
<p>The board’s RSSI pad can be used as an analog RSSI input. Use pin “0” as the RSSI input pin in Mission Planner. Mission planner default values for battery voltage and current scales are provided, however since many variations of this board are available, these may needed to be manually calibrated.</p>
<p>The RSSI pad can be re-purposed to be the TX output of UART4 instead of analog RSSI input, if the <a class="reference internal" href="parameters.html#brd-alt-config"><span class="std std-ref">BRD_ALT_CONFIG</span></a> param is set to 2 or 3. And if <a class="reference internal" href="parameters.html#brd-alt-config"><span class="std std-ref">BRD_ALT_CONFIG</span></a> param is set to 3, then PWM output pin 5 becomes instead, the RX pin of UART4 to provide a full addition UART. Also, if <a class="reference internal" href="parameters.html#brd-alt-config"><span class="std std-ref">BRD_ALT_CONFIG</span></a> param is set to 4, then both UART3 and UART4 are active and available.</p>
<p>If you want to power the servos from the ESC BEC via the board’s center rail for the servo outputs, then you should remove the diode as per here: <a class="reference external" href="https://www.rcgroups.com/forums/showthread.php?2874687">https://www.rcgroups.com/forums/showthread.php?2874687</a>, otherwise, independently power the servos directly from the ESC or independent BEC with no connection to the board’s servo output center rail. The VCC pin next to the RX in pin is a 5V output only and not affected by this modification.</p>
<div class="figure">
<a class="reference external image-reference" href="../_images/OMNIBUSF4Pro_remove_diode.jpg"><img alt="../_images/OMNIBUSF4Pro_remove_diode.jpg" src="../_images/OMNIBUSF4Pro_remove_diode.jpg" style="width: 450px;" /></a>
</div>
<p>Video power provided on the video input and output center rail, is provide through an on-board noise filter. Either ~4.5V (labeled 5V) or VBAT-0.5V (VBAT) can be selected by solder pads on the back of the board.</p>
<p>PPM solder pad/resistor should be soldered and “S-BUS” resistor/solder pad removed
Otherwise, UART1 or UART6 or RCIN will not work.</p>
<div class="figure">
<a class="reference external image-reference" href="../_images/omnibusf4pro_ardupilot_wiring.jpg"><img alt="../_images/omnibusf4pro_ardupilot_wiring.jpg" src="../_images/omnibusf4pro_ardupilot_wiring.jpg" style="width: 450px;" /></a>
</div>
</div>
<div class="section" id="pwm-outputs">
<h2>PWM Outputs<a class="headerlink" href="#pwm-outputs" title="Permalink to this headline">¶</a></h2>
<p>The Pro version has 6 PWM outputs available on thru-hole pads, and two additional (PWM7 &amp; PWM8) on the rear, via solder pads above the “MOTO” silk screen printing. The AIO version only provides 6 PWM outputs via thru-hole pads.</p>
<div class="figure">
<a class="reference external image-reference" href="../_images/PWM7-8.jpg"><img alt="../_images/PWM7-8.jpg" src="../_images/PWM7-8.jpg" style="width: 450px;" /></a>
</div>
</div>
<div class="section" id="default-uart-order">
<h2>Default UART order<a class="headerlink" href="#default-uart-order" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>SERIAL0 = console = USB</li>
<li>SERIAL1 = Telemetry1 = USART1</li>
<li>SERIAL2 = not assigned (Telemetry2 = USART3 if <a class="reference internal" href="parameters.html#brd-alt-config"><span class="std std-ref">BRD_ALT_CONFIG</span></a> =1)</li>
<li>SERIAL3 = GPS1 = USART6</li>
<li>SERIAL4 = GPS2 = UART4 (if <a class="reference internal" href="parameters.html#brd-alt-config"><span class="std std-ref">BRD_ALT_CONFIG</span></a> = 2 or 3)</li>
<li>SERIAL5 = not assigned</li>
<li>SERIAL6 = not assigned</li>
</ul>
<p>Serial protocols can be adjusted to personal preferences.</p>
</div>
<div class="section" id="dshot-capability">
<h2>Dshot capability<a class="headerlink" href="#dshot-capability" title="Permalink to this headline">¶</a></h2>
<p>All motor/servo outputs are Dshot and PWM capable. However, mixing Dshot and normal PWM operation for outputs is restricted into groups, ie. enabling Dshot for an output in a group requires that ALL outputs in that group be configured and used as Dshot, rather than PWM outputs. The output groups that must be the same (PWM rate or Dshot, when configured as a normal servo/motor output) are: 1/2/6, 3/4/5, 7/8(Pro only).</p>
</div>
<div class="section" id="flashing-firmware">
<h2>Flashing Firmware<a class="headerlink" href="#flashing-firmware" title="Permalink to this headline">¶</a></h2>
<p>Usually these boards are sold pre-flashed with betaflight / INav firwares and require both firmware and bootloader to be updated if you want to use ArduPilot, as an ArduPilot-compatible bootloader is required for subsequent ArduPilot firmware-upgrade handling.</p>
<p>Firmware files can be found <a class="reference external" href="https://firmware.ardupilot.org/">here</a>.
Use omnibusf4pro firmware for the OmnibusF4Pro boards and omnibusf4 firmware for the AIO versions. The pro version will be used in the following examples.
Besides the .apj files for firmware flashing via MissionPlanner, there’s also .hex files for use with various utilities like dfu-util or betaflight / iNav GUIs. You will also find a _bl.hex that contains the firmware plus the ArduPilot compatible bootloader in case it is not already present on your board.</p>
<p>The provided _bl.hex file can be flashed using BF or iNav GUI, likely the most convenient way to get ArduPilot on your board the first time.</p>
<p>Alternatively, the bootloader can be flashed separately. This requires the board to be put into DFU mode. Tools like dfu-util can be used to flash the bootlader. Once the bootlader is present, all subsequent firmware updates can be done using MissionPlanner’s firmware functions.</p>
<div class="section" id="enter-dfu-mode">
<h3>Enter DFU Mode<a class="headerlink" href="#enter-dfu-mode" title="Permalink to this headline">¶</a></h3>
<p>To do this, you’ll need to locate the DFU jumper on your board. On most board flavours this is a little push button thas needs to be
pressed while connecting your board to your PC via USB:</p>
<a class="reference external image-reference" href="../_images/omnibusf4_dfu_button.png"><img alt="../_images/omnibusf4_dfu_button.png" src="../_images/omnibusf4_dfu_button.png" /></a>
</div>
<div class="section" id="install-dfu-util">
<h3>Install dfu-util<a class="headerlink" href="#install-dfu-util" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">Linux (Ubuntu)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">dfu</span><span class="o">-</span><span class="n">util</span>
</pre></div>
</div>
</li>
<li><p class="first">OS X</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brew</span> <span class="n">install</span> <span class="n">dfu</span><span class="o">-</span><span class="n">util</span>
</pre></div>
</div>
</li>
<li><p class="first">Windows</p>
<p>Download the <a class="reference external" href="http://dfu-util.sourceforge.net/releases/dfu-util-0.8-binaries/win32-mingw32/dfu-util-static.exe">dfu-util</a> to your local system, e.g., under <cite>D:dfu-util</cite>.</p>
<p>Rename it to <cite>dfu-util.exe</cite></p>
<p>Append the path of the <cite>dfu-util.exe</cite> to the system environment variable <cite>Path</cite>: “My Computer” &gt; “Properties” &gt; “Advanced” &gt; “Environment Variables” &gt; “Path”. Please note that paths in the variable <cite>Path</cite> are seperated by semicolon <cite>;</cite>. This will allow dfu-util to be executed globally in command prompt.</p>
<p>Instead of using dfu-util, you could flash bootloader with betaflight. Instructions are detailled here : <a class="reference external" href="https://github.com/betaflight/betaflight/wiki/Installing-Betaflight">https://github.com/betaflight/betaflight/wiki/Installing-Betaflight</a>
If you board is not recognize as a com port under windows, you have to download and install zadig : <a class="reference external" href="http://zadig.akeo.ie/">http://zadig.akeo.ie/</a></p>
</li>
</ul>
</div>
<div class="section" id="flash-bootloader">
<h3>Flash Bootloader<a class="headerlink" href="#flash-bootloader" title="Permalink to this headline">¶</a></h3>
<p>Bootloader binaries for the current targets can be found <a class="reference external" href="https://firmware.ardupilot.org/Tools/Bootloaders">here</a>.</p>
<p>Download omnibusf4pro_bl.bin for this board type. With your board connected via USB and put into DFU mode, open a terminal and flash the new bootloader with the following command line:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">dfu</span><span class="o">-</span><span class="n">util</span> <span class="o">-</span><span class="n">d</span> <span class="mi">0483</span><span class="p">:</span><span class="n">df11</span> <span class="o">-</span><span class="n">c</span> <span class="mi">1</span> <span class="o">-</span><span class="n">i</span> <span class="mi">0</span>  <span class="o">-</span><span class="n">a</span> <span class="mi">0</span>  <span class="o">-</span><span class="n">D</span> <span class="n">omnibusf4pro_bl</span><span class="o">.</span><span class="n">bin</span>  <span class="o">-</span><span class="n">s</span> <span class="mh">0x08000000</span>
</pre></div>
</div>
<p>Once the flashing is complete, power cycle the board and you should see a solid power LED and a rapidly blinking blue LED.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Alternatively, board-specific bootloaders can be built from source with ./waf using the –bootloader option.</p>
</div>
</div>
<div class="section" id="flash-ardupilot">
<h3>Flash ArduPilot<a class="headerlink" href="#flash-ardupilot" title="Permalink to this headline">¶</a></h3>
<p>Open Mission Planner and go to the Initial Setup tab. Verify that the COM port in the top right is the same as in Device Manager.</p>
<a class="reference external image-reference" href="../_images/openpilot-revo-mini-com-ports.png"><img alt="../_images/openpilot-revo-mini-com-ports.png" src="../_images/openpilot-revo-mini-com-ports.png" /></a>
<p>Choose “Load Custom Firmware” and browse to the respective .apj file. After the flash is complete, power cycle the device.</p>
<a class="reference external image-reference" href="../_images/openpilot-revo-mini-load-firmware.png"><img alt="../_images/openpilot-revo-mini-load-firmware.png" src="../_images/openpilot-revo-mini-load-firmware.png" /></a>
<p>Congratulations! You’re now running ArduPilot on your omnibusF4. You can use this same process to upgrade to newer versions of ArduPilot. Either use MP’s firmware update functionality or compile your own desired vehicle firmware from source and upload the .apj file to the board.</p>
</div>
<div class="section" id="compile-ardupilot">
<h3>Compile ArduPilot<a class="headerlink" href="#compile-ardupilot" title="Permalink to this headline">¶</a></h3>
<p>To build your own firmware, see the instructions on setting up a build envrionment and compiling the source code:
<a class="reference external" href="https://ardupilot.org/dev/docs/building-the-code.html">Building the Code</a></p>
</div>
<div class="section" id="configuration">
<h3>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h3>
<p>Enable Battery monitor with these settings :</p>
<p>BATT_MONITOR=4</p>
<p>Then reboot.</p>
<p><a class="reference internal" href="parameters.html#batt-volt-pin"><span class="std std-ref">BATT_VOLT_PIN</span></a> 12</p>
<p><a class="reference internal" href="parameters.html#batt-curr-pin"><span class="std std-ref">BATT_CURR_PIN</span></a> 11</p>
<p><a class="reference internal" href="parameters.html#batt-volt-mult"><span class="std std-ref">BATT_VOLT_MULT</span></a> 11.0</p>
<p><a class="reference internal" href="parameters.html#batt-amp-pervlt"><span class="std std-ref">BATT_AMP_PERVLT</span></a> 38.0 (note, this value may vary from 18 to 38, depending on specific board manufacturer…will need to be calibrated to match actual current)</p>
</div>
</div>
<div class="section" id="how-to-trigger-a-camera-with-relay-pin">
<h2>How to trigger a camera with relay pin<a class="headerlink" href="#how-to-trigger-a-camera-with-relay-pin" title="Permalink to this headline">¶</a></h2>
<p>All PWM could be use as relay. <a class="reference internal" href="parameters.html#brd-pwm-count"><span class="std std-ref">BRD_PWM_COUNT</span></a> have to be set.</p>
<p><a class="reference internal" href="parameters.html#brd-pwm-count"><span class="std std-ref">BRD_PWM_COUNT</span></a> = 2
<a class="reference internal" href="parameters.html#relay-pin"><span class="std std-ref">RELAY_PIN</span></a> = 15 # for output PWM 5</p>
<p>if we want to set PWM 6 as relay pin :
<a class="reference internal" href="parameters.html#relay-pin"><span class="std std-ref">RELAY_PIN</span></a> = 41 # for output PWM 6</p>
<p>Hardware definition is available <a class="reference external" href="https://github.com/ArduPilot/ardupilot/blob/master/libraries/AP_HAL_ChibiOS/hwdef/omnibusf4pro/hwdef.dat">here</a>.</p>
</div>
</div>


            
            
             
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="common-omnibusnanov6.html" class="btn btn-neutral float-right" title="Omnibus F4 Nano V6 and V6.x" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="common-mro-nexus.html" class="btn btn-neutral" title="mRo Nexus" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>
  
  
  Questions, issues, and suggestions about this page can be raised on the <a href="https://discuss.ardupilot.org">forums</a>. Issues and suggestions may be posted on the forums or the <a href="https://github.com/ArduPilot/ardupilot_wiki/issues/new?title=Omnibus F4 Pro (on-board current sensor) and Omnibus F4 AIO (no sensor onboard)&amp;body=[Omnibus F4 Pro (on-board current sensor) and Omnibus F4 AIO (no sensor onboard)](https://ardupilot.org/copter/docs/common-omnibusf4pro.html)%20-%20Describe%20the%20issue/suggestion%20and%20improve%20the%20title.%20Please%20keep%20a%20link%20to%20the%20original%20article%20if%20relevant.&amp;labels=docs">Github Issue Tracker</a>.
  <hr/>

  <div role="contentinfo">
    <p>
    <a style="float:right;" rel="license" href="https://creativecommons.org/licenses/by-sa/3.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/3.0/88x31.png" /></a>
        &copy; Copyright 2020, ArduPilot Dev Team.

    </p>
  </div>
  


</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/language_data.js"></script>
      <script type="text/javascript" src="../_static/./useralerts.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
    <script type="text/javascript" src="../_static/js/menubar.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   


<!-- Google Analytics -->
<!-- This is official ArduPilot analytics account -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  _gaq.push(['_trackPageLoadTime']);
  _gaq.push(["_setSiteSpeedSampleRate", 0]);
  ga('create', 'UA-75650032-1', 'auto');
  ga('send', 'pageview');

</script>
<!-- Google Analytics -->

</body>
</html>