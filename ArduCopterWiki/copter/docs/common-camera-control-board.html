

<!-- Path to wiki directories, without backslash -->

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Archived:Open Camera Control Board &mdash; Copter  documentation</title>
  

  <!-- favicon -->
  
  
    <link rel="shortcut icon" href="../_static/favicon_copter.ico"/>
  
  <!-- favicon end -->
  
  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/common_theme_override.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="Copter  documentation" href="../index.html"/>
        <link rel="up" title="Archived Topics" href="common-archived-topics.html"/>
        <link rel="next" title="Archived:VR Gimbal Controller (3-Axis Open Source)" href="common-vrgimbal.html"/>
        <link rel="prev" title="Archived: Qualcomm Snapdragon Flight Kit" href="common-qualcomm-snapdragon-flight-kit.html"/>  
  <script type="text/javascript">
  window.liveSettings = {
    api_key: "53747d3f35bf4cec9372629094cd9fe2",
    picker: "bottom-right",
    detectlang: true,
    autocollect: true,
    dynamic: false
  };
  </script>


  
  <script src="../_static/js/modernizr.min.js"></script>

</head>



<body class="wy-body-for-nav" role="document">

        
    <div id='cssmenu'>
        <ul>
           <li><a href='/ardupilot/index.html'>Home</a>
              <ul>
                 <li><a href='/copter/index.html'>Copter</a></li>
                 <li><a href='/plane/index.html'>Plane</a></li>
                 <li><a href='/rover/index.html'>Rover</a></li>
                 <li><a href='http://ardusub.com/'>Sub</a></li>
                 <li><a href='/antennatracker/index.html'>AntennaTracker</a></li>
                 <li><a href='/planner/index.html'>Mission Planner</a></li>
                 <li><a href='/planner2/index.html'>APM Planner 2</a></li>
                 <li><a href='/mavproxy/index.html'>MAVProxy</a></li>
                 <li><a href='/dev/docs/companion-computers.html'>Companion Computers</a></li>
                 <li><a href='/dev/index.html'>Developer</a></li>
              </ul>
           </li>
           
          
           
           <li><a href='https://firmware.ardupilot.org/'>Downloads</a>
              <ul>
                <li><a href='https://firmware.ardupilot.org/Tools/MissionPlanner/'>Mission Planner</a></li>
                <li><a href='https://firmware.ardupilot.org/Tools/APMPlanner/'>APM Planner 2</a></li>
                   <li><a title="Advanced User Tools" href="common-downloads_advanced_user_tools.html">Advanced User Tools</a></li>
                   <li><a title="Developer Tools" href="common-downloads_developer_tools.html">Developer Tools</a></li>
                   <li><a title="Firmware" href="common-downloads_firmware.html">Firmware</a></li>
                </ul>
           </li>
           
           <li><a href='https://discuss.ardupilot.org' />Community</a>
              <ul>
                 <li><a href='https://discuss.ardupilot.org/'>Support Forums</a></li>
                 <li><a href='https://www.facebook.com/groups/ArduPilot.org'>Facebook</a></li>
                 <li><a href='https://ardupilot.org/discord'>Developer Chat (Discord)</a></li>
                 <li><a href='https://ardupilot.org/discord'>Developer Voice (Discord)</a></li>
				 <li><a href='https://ardupilot.org/dev/docs/common-contact-us.html'>Contact us</a></li>
				 <li><a href='https://ardupilot.org/dev/index.html#getting-involved'>Getting involved</a></li>
                   <li><a title="Commercial Support" href="common-commercial-support.html">Commercial Support</a></li>
                   <li><a title="Dev Team" href="common-team.html">Development Team</a></li>
                   <li><a title="Training Centers" href="common-training-centers.html">UAS Training Centers</a></li>
              </ul>
           </li>
             <li><a title="Stores" href="common-stores.html">Stores</a></li>


             <li><a title="SWAG Shop" href="https://shop.ardupilot.org">SWAG</a></li>

           
           
                        <li><a title="About" href="../index.html">About</a>
               <ul>
                   <li><a title="Project News" href="project-news.html">News</a></li>
                   <li><a title="History of ArduPilot" href="common-history-of-ardupilot.html">History</a></li>
                   <li><a href='https://ardupilot.org/dev/docs/license-gplv3.html'>License</a></li>
                   <li><a href='https://ardupilot.org/dev/docs/trademark.html'>Trademark</a></li>
                   <li><a title="Acknowledgments" href="common-acknowledgments.html">Acknowledgments</a></li>
                   <li><a title="Wiki Editing Guide" href="common-wiki_editing_guide.html">Wiki Editing Guide</a></li>
               </ul>
             </li>
        </ul>
        
<style>
#jdlogo {
  top: 10px;
  right: 20px;
  position: absolute;
  color: #dddddd;
}
#jdlogo a:visited,
#jdlogo a:link {
  color: #9B59B6;
}
#jdlogo a:hover,
#jdlogo a:active {
  color: #CACACA;
}
</style>

</div>

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        
          <a href="../index.html" class="icon icon-home"> Copter
        

        
          
          <img src="../_static/ardupilot_logo.png" class="logo" />
        
        </a>

        
          
          
        

        
          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        
        
        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introducing Copter</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-autopilots.html">AutoPilot Hardware Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="initial-setup.html">First Time Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="flying-arducopter.html">First Flight</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-when-problems-arise.html">If A Problem Arises</a></li>
<li class="toctree-l1"><a class="reference internal" href="copter-flight-features.html">Flight Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-advanced-configuration.html">Advanced Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-mission-planning.html">Mission Planning</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-logs.html">Logs</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-optional-hardware.html">Peripheral Hardware</a></li>
<li class="toctree-l1"><a class="reference internal" href="traditional-helicopters.html">Traditional Helicopters</a></li>
<li class="toctree-l1"><a class="reference internal" href="tricopter.html">Tricopter</a></li>
<li class="toctree-l1"><a class="reference internal" href="singlecopter-and-coaxcopter.html">SingleCopter and CoaxCopter</a></li>
<li class="toctree-l1"><a class="reference internal" href="heliquads.html">HeliQuads</a></li>
<li class="toctree-l1"><a class="reference internal" href="skyrocket.html">SkyRocket</a></li>
<li class="toctree-l1"><a class="reference internal" href="solo_arducopter_upgrade.html">Solo</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference-frames.html">Reference Frames</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-use-cases-and-applications.html">Use-Cases and Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-antenna-tracking.html">Antenna Tracking</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-simulation.html">Simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-master-features.html">Upcoming Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-user-alerts.html">User Alerts</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="common-appendix.html">Appendix</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="common-abbreviations.html">Abbreviations</a></li>
<li class="toctree-l2"><a class="reference internal" href="common-acknowledgments.html">Acknowledgments</a></li>
<li class="toctree-l2"><a class="reference internal" href="common-downloads_advanced_user_tools.html">Advanced user tools (downloads)</a></li>
<li class="toctree-l2"><a class="reference internal" href="common-commercial-support.html">Commercial Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="common-contact-us.html">Contact Us</a></li>
<li class="toctree-l2"><a class="reference internal" href="common-downloads_developer_tools.html">Developer tools (downloads)</a></li>
<li class="toctree-l2"><a class="reference internal" href="common-donation.html">Donating to ArduPilot</a></li>
<li class="toctree-l2"><a class="reference internal" href="common-downloads_firmware.html">Firmware (downloads)</a></li>
<li class="toctree-l2"><a class="reference internal" href="common-glossary.html">Glossary</a></li>
<li class="toctree-l2"><a class="reference internal" href="common-history-of-ardupilot.html">History of ArduPilot</a></li>
<li class="toctree-l2"><a class="reference internal" href="common-partners.html">Partners</a></li>
<li class="toctree-l2"><a class="reference internal" href="common-partners-program.html">Partners Program</a></li>
<li class="toctree-l2"><a class="reference internal" href="common-rtf.html">Ready-To-Use vehicles</a></li>
<li class="toctree-l2"><a class="reference internal" href="common-stores.html">Stores</a></li>
<li class="toctree-l2"><a class="reference internal" href="common-team.html">Top Contributors</a></li>
<li class="toctree-l2"><a class="reference internal" href="common-training-centers.html">Training Centers</a></li>
<li class="toctree-l2"><a class="reference internal" href="common-wiki_editing_guide.html">Wiki Editing Guide</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="common-archived-topics.html">Archived Topics</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="common-loading-chibios-firmware-onto-pixhawk.html">Loading ChibiOS firmware onto Pixhawk</a></li>
<li class="toctree-l3"><a class="reference internal" href="common-navio-overview.html">NAVIO+ Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="common-apm25-and-26-overview.html">APM 2.x</a></li>
<li class="toctree-l3"><a class="reference internal" href="common-px4fmu-overview.html">PX4FMU</a></li>
<li class="toctree-l3"><a class="reference internal" href="common-px4io-overview.html">PX4IO</a></li>
<li class="toctree-l3"><a class="reference internal" href="common-qualcomm-snapdragon-flight-kit.html">Qualcomm Snapdragon Flight Kit</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Open Camera Control Board</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#port-mapping">Port Mapping</a></li>
<li class="toctree-l4"><a class="reference internal" href="#usb-connector-types">USB Connector Types</a></li>
<li class="toctree-l4"><a class="reference internal" href="#computer-wiring-table-tests-and-firmware-uploading">Computer Wiring - Table Tests and Firmware Uploading</a></li>
<li class="toctree-l4"><a class="reference internal" href="#autopilot-wiring-aerial-photography">Autopilot Wiring - Aerial Photography</a></li>
<li class="toctree-l4"><a class="reference internal" href="#contact-closure-example-canon-xti">Contact Closure - Example: Canon XTi</a></li>
<li class="toctree-l4"><a class="reference internal" href="#mavlink-detailed">MAVLink Detailed</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="common-vrgimbal.html">VR Gimbal Controller (3-Axis Open Source)</a></li>
<li class="toctree-l3"><a class="reference internal" href="common-disabling-the-built-in-gps-on-apm2-to-use-an-external-gps-instead.html">External GPS AP2.x</a></li>
<li class="toctree-l3"><a class="reference internal" href="common-mounting-the-gps-module.html">GPS Module (External)</a></li>
<li class="toctree-l3"><a class="reference internal" href="common-external-magnetometer-for-improved-performance.html">External Compass (Magnetometer)</a></li>
<li class="toctree-l3"><a class="reference internal" href="common-recording-and-playing-back-missions.html">Recording and Playing Back Missions</a></li>
<li class="toctree-l3"><a class="reference internal" href="common-using-a-current-sensor.html">AttoPilot Current/Voltage Sensor</a></li>
<li class="toctree-l3"><a class="reference internal" href="common-erle-brain2-wiring-quick-start.html">Erle-Brain2 Wiring Quick Start</a></li>
<li class="toctree-l3"><a class="reference internal" href="common-pxfmini-wiring-quick-start.html">PXFmini Wiring Quick Start</a></li>
<li class="toctree-l3"><a class="reference internal" href="common-edge-quick-start.html">Edge Quick Start</a></li>
<li class="toctree-l3"><a class="reference internal" href="xbee-radios.html">Using Xbee radios for telemetry with APM</a></li>
<li class="toctree-l3"><a class="reference internal" href="quick-start-guide.html">Quick Start for RTFs</a></li>
<li class="toctree-l3"><a class="reference internal" href="hil-quad.html">HIL Quad Simulator</a></li>
<li class="toctree-l3"><a class="reference internal" href="tradhelihil.html">Traditional Helicopter Simulator – TradHeliHIL</a></li>
<li class="toctree-l3"><a class="reference internal" href="px4fmu-only-wiring.html">Installing the PX4FMU on a QuadCopter</a></li>
<li class="toctree-l3"><a class="reference internal" href="archived-gps-failsafe.html">GPS Failsafe</a></li>
<li class="toctree-l3"><a class="reference internal" href="traditional-helicopter-archived-tuning.html">Archived: Traditional Helicopter – Tuning with Copter 3.3 and earlier</a></li>
<li class="toctree-l3"><a class="reference internal" href="hoverthings-flip-sport-quadcopter.html">Hoverthings Flip Sport Quadcopter (detailed build)</a></li>
<li class="toctree-l3"><a class="reference internal" href="dji-f330-flamewheel.html">DJI F330 FlameWheel QuadCopter</a></li>
<li class="toctree-l3"><a class="reference internal" href="build-your-own-multicopter.html">Build Your Own Multicopter</a></li>
<li class="toctree-l3"><a class="reference internal" href="advanced-multicopter-design.html">Advanced MultiCopter Design</a></li>
<li class="toctree-l3"><a class="reference internal" href="improving-the-capabilities-of-your-multicopter.html">Improving the Capabilities of Your Multicopter</a></li>
<li class="toctree-l3"><a class="reference internal" href="pdf-guides.html">PDF Guides</a></li>
<li class="toctree-l3"><a class="reference internal" href="project-news.html">Copter Project News</a></li>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l3"><a class="reference internal" href="landing-gear.html">Landing Gear</a></li>
<li class="toctree-l3"><a class="reference internal" href="common-mouse-based-optical-flow-sensor-adns3080.html">ADNS3080 Mouse Sensor (no longer supported)</a></li>
<li class="toctree-l3"><a class="reference internal" href="sonar.html">Analog Sonar (AC3.1)</a></li>
<li class="toctree-l3"><a class="reference internal" href="archived-tricopter.html">Copter 3.4.x</a></li>
<li class="toctree-l3"><a class="reference internal" href="archived-tricopter.html#copter-3-3-x">Copter 3.3.x</a></li>
<li class="toctree-l3"><a class="reference internal" href="archived-tricopter.html#copter-3-2-1-and-earlier">Copter 3.2.1 (and earlier)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="common-table-of-contents.html">Full Table of Contents</a></li>
</ul>

          
        
        
        <!-- add paypal and dronecode logos -->
                <div style="margin: auto; padding-left:20px; padding-right:20px; width=100%">

        <hr />
        <form style="margin:auto;" action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
        <input type="hidden" name="cmd" value="_s-xclick" />
        <input type="hidden" name="hosted_button_id" value="BBF28AFAD58B2" />
        <input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_donate_LG.gif" border="0" name="submit" title="PayPal - The safer, easier way to pay online!" alt="Donate" />
        </form>
        <br>
        <a href="common-donation.html">Individual</a>
        <a href="common-partners.html">Partners</a>
        <a href="https://shop.ardupilot.org">SWAG Shop</a>

        <hr />
        </div>
        <!-- endadd paypal and dronecode logos -->
              
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">Copter</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



 
 
 
 
 
  
   
 

<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="common-appendix.html">Appendix</a> &raquo;</li>
      
          <li><a href="common-archived-topics.html">Archived Topics</a> &raquo;</li>
      
    <li>Archived:Open Camera Control Board</li>
      <li class="wy-breadcrumbs-aside">
                
          
            <a href="https://github.com/ArduPilot/ardupilot_wiki/blob/master/common/source/docs/common-camera-control-board.rst" class="fa fa-github"> Edit on GitHub</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="archived-open-camera-control-board">
<span id="common-camera-control-board"></span><h1>Archived:Open Camera Control Board<a class="headerlink" href="#archived-open-camera-control-board" title="Permalink to this headline">¶</a></h1>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><em>The Open CCB is not yet commercially available - we are actively
seeking manufacturers. (even though this topic is archived!)</em> If you
want to start making and selling this board please contact
<a class="reference external" href="mailto:CraigElder&#37;&#52;&#48;uniserve">CraigElder<span>&#64;</span>uniserve</a>.</p>
</div>
<p>The Open Camera Control Board (OpenCCB) is a camera remote control
interface for aerial photography.
It has <a class="reference internal" href="#common-camera-control-board-port-mapping"><span class="std std-ref">many features</span></a>,
including: FTDI USB/UART adapter, USB HOST,
Digital IO, Analog IO, Optocoupled IO, etc.</p>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<a class="reference external image-reference" href="../_images/Persp_sml.jpg"><img alt="../_images/Persp_sml.jpg" src="../_images/Persp_sml.jpg" /></a>
<p>The main camera control protocol used is known as PTP (Picture Transfer
Protocol), which was originally standardized as PIMA 15740:2000, ISO
15740:2005(V1.0), and ISO 15740:2008(V1.1).</p>
<p>The PTP has been supported by almost all cameras since 2005, but often
in a limited fashion. Only few cameras have the “PTP Remote Control”
feature. Canon, for example, removed the remote control feature from
their compact line (PowerShot models) in the last PS SDK in 2009
(PS-ReCSDK 1.1.0e).</p>
<p>Fortunately the PTP hacking extension in the <a class="reference external" href="http://chdk.wikia.com/wiki/PTP_Extension">CHDK project</a> allows us to
extend the PTP control to newer, smaller and lighter Canon PowerShot
models.</p>
<p>The CHDK PTP interface is described below:</p>
<a class="reference external image-reference" href="../_images/Diagram_MAVPTP.jpg"><img alt="../_images/Diagram_MAVPTP.jpg" src="../_images/Diagram_MAVPTP.jpg" /></a>
</div>
<div class="section" id="port-mapping">
<span id="common-camera-control-board-port-mapping"></span><h2>Port Mapping<a class="headerlink" href="#port-mapping" title="Permalink to this headline">¶</a></h2>
<a class="reference external image-reference" href="../_images/Ports.jpg"><img alt="../_images/Ports.jpg" src="../_images/Ports.jpg" /></a>
<table border="1" class="docutils">
<tbody>
<tr>
<th colspan="6">Telemetry UART (Auto Pilot)</th>
</tr>
<tr>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>5</td>
<td>6</td>
</tr>
<tr>
<td>5V</td>
<td>TX</td>
<td>RX</td>
<td>CTS</td>
<td>RTS</td>
<td>GND</td>
</tr>
</tbody>
</table>



<table border="1" class="docutils">
<tbody>
<tr>
<th colspan="4">I2C (3V3)</th>
</tr>
<tr>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
</tr>
<tr>
<td>GND</td>
<td>SCA</td>
<td>SCL</td>
<td>3V3</td>
</tr>
</tbody>
</table>



<table border="1" class="docutils">
<tbody>
<tr>
<th colspan="4">Digital IO</th>
</tr>
<tr>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
</tr>
<tr>
<td>GND</td>
<td>D2</td>
<td>D8</td>
<td>D7</td>
</tr>
</tbody>
</table>



<table border="1" class="docutils">
<tbody>
<tr>
<th colspan="4">Analog IO</th>
</tr>
<tr>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
</tr>
<tr>
<td>GND</td>
<td>A1</td>
<td>A2</td>
<td>A3</td>
</tr>
</tbody>
</table>


<table border="1" class="docutils">
<tbody>
<tr>
<th colspan="3">Optocoupled IO (LANC-C Control)</th>
</tr>
<tr>
<td>1</td>
<td>2</td>
<td>3</td>
</tr>
<tr>
<td>V+ LAN-C(5-9V)</td>
<td>LAN-C Line</td>
<td>GND LAN-C</td>
</tr>
</tbody>
</table>



<table border="1" class="docutils">
<tbody>
<tr>
<th colspan="3">Optocoupled IO (Contact Closure Triggering)</th>
</tr>
<tr>
<td>1</td>
<td>2</td>
<td>3</td>
</tr>
<tr>
<td>NC</td>
<td>Shutter</td>
<td>Ground</td>
</tr>
</tbody>
</table></div>
<div class="section" id="usb-connector-types">
<h2>USB Connector Types<a class="headerlink" href="#usb-connector-types" title="Permalink to this headline">¶</a></h2>
<a class="reference external image-reference" href="../_images/USB_plugs.jpg"><img alt="../_images/USB_plugs.jpg" src="../_images/USB_plugs.jpg" /></a>
</div>
<div class="section" id="computer-wiring-table-tests-and-firmware-uploading">
<h2>Computer Wiring - Table Tests and Firmware Uploading<a class="headerlink" href="#computer-wiring-table-tests-and-firmware-uploading" title="Permalink to this headline">¶</a></h2>
<a class="reference external image-reference" href="../_images/TableTestWiring.jpg"><img alt="../_images/TableTestWiring.jpg" src="../_images/TableTestWiring.jpg" /></a>
</div>
<div class="section" id="autopilot-wiring-aerial-photography">
<h2>Autopilot Wiring - Aerial Photography<a class="headerlink" href="#autopilot-wiring-aerial-photography" title="Permalink to this headline">¶</a></h2>
<a class="reference external image-reference" href="../_images/BasicWiring.jpg"><img alt="../_images/BasicWiring.jpg" src="../_images/BasicWiring.jpg" /></a>
<p>The firmware can be found <a class="reference external" href="https://github.com/sandrobenigno/3dr-camera-ctrl">here on GitHub</a>.</p>
<p>There is also a <a class="reference external" href="https://github.com/sandrobenigno/3dr-camera-ctrl/archive/master.zip">zip file</a>
of the repository.</p>
<p>After getting the source code, just follow the steps below:</p>
<p>Step 1: Set your Arduino SketchBook path to the main folder</p>
<p>Step 2: Select the sketch “ArduCAMPTP_CHDK_APM26”</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>If you want the camera showing lenses when connected, you need to
change the file __defines.h by setting AUTOSTART to 1, like here:</p>
<div class="last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#define AUTOSTART 1 //Expose lens on start (Start on Record Mode)</span>
</pre></div>
</div>
</div>
<p>Step 3: Compile and upload it to CCB board</p>
<p>Step 4: Copy the file geoshot.lua to camera’s SD card (folder:
/CHDK/SCRIPTS/)</p>
<p>Step 5: While the autopilot is connected to MissionPlanner,
do set the shutter just like here:</p>
<a class="reference external image-reference" href="../_images/Shutter_Setup.jpg"><img alt="../_images/Shutter_Setup.jpg" src="../_images/Shutter_Setup.jpg" /></a>
<p>Step 6: Test shooting</p>
<a class="reference external image-reference" href="../_images/maps.jpg"><img alt="../_images/maps.jpg" src="../_images/maps.jpg" /></a>
<p>After that… any other command should work… because it acts just like
a servo.</p>
</div>
<div class="section" id="contact-closure-example-canon-xti">
<h2>Contact Closure - Example: Canon XTi<a class="headerlink" href="#contact-closure-example-canon-xti" title="Permalink to this headline">¶</a></h2>
<a class="reference external image-reference" href="../_images/ContactClosureWiring.jpg"><img alt="../_images/ContactClosureWiring.jpg" src="../_images/ContactClosureWiring.jpg" /></a>
</div>
<div class="section" id="mavlink-detailed">
<h2>MAVLink Detailed<a class="headerlink" href="#mavlink-detailed" title="Permalink to this headline">¶</a></h2>
<p>Currently, the code is using RC Channels from MAVLink. It does work like
a virtual servo, i.e. those messages do reflect the status of every
single output channel from the autopilot.</p>
<p>Take a look at the most important piece of code from the file
“<a class="reference external" href="https://github.com/sandrobenigno/3dr-camera-ctrl/blob/master/ArduCAMPTP_CHDK_APM26/MAVcomm.h">MAVcomm.h</a>”:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">case</span> <span class="nl">MAVLINK_MSG_ID_RC_CHANNELS_RAW</span><span class="p">:</span> <span class="c1">//RC INPUT BYPASSED BY APM:</span>
    <span class="p">{</span>
    <span class="n">drone_chan</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">mavlink_msg_rc_channels_raw_get_chan5_raw</span><span class="p">(</span><span class="o">&amp;</span><span class="n">msg</span><span class="p">);</span>
    <span class="n">drone_chan</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">mavlink_msg_rc_channels_raw_get_chan6_raw</span><span class="p">(</span><span class="o">&amp;</span><span class="n">msg</span><span class="p">);</span>
    <span class="n">drone_chan</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">mavlink_msg_rc_channels_raw_get_chan7_raw</span><span class="p">(</span><span class="o">&amp;</span><span class="n">msg</span><span class="p">);</span>
    <span class="n">drone_chan</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">mavlink_msg_rc_channels_raw_get_chan8_raw</span><span class="p">(</span><span class="o">&amp;</span><span class="n">msg</span><span class="p">);</span>
    <span class="p">}</span>
</pre></div>
</div>
<p>The triggering is flagged by this small piece of code from the same
file:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#ifdef DRONE_OUT</span>
          <span class="k">if</span><span class="p">(</span><span class="n">cam_ctrl_state</span><span class="p">.</span><span class="n">shot</span>  <span class="mi">1500</span><span class="p">))</span> <span class="n">cam_ctrl_state</span><span class="p">.</span><span class="n">shot</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="cp">#endif</span>
</pre></div>
</div>
<p>The flag “cam_ctrl_state.shot” is set to “1” so the board can shot and
set it back to “0”.</p>
<p>By default, the code above is using the RC8 from the autopilot. It
is defined on the file
“<a class="reference external" href="https://github.com/sandrobenigno/3dr-camera-ctrl/blob/master/ArduCAMPTP_CHDK_APM26/__defines.h">__defines.h</a>”
like shown here:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">//Define what FC OUT channel is the trigger</span>

<span class="cp">#define DRONE_OUT 1 </span><span class="c1">//Shutter RC8</span>
</pre></div>
</div>
<p>The shooting function uses some Attitude data as well:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">case</span> <span class="nl">MAVLINK_MSG_ID_ATTITUDE</span><span class="p">:</span>
<span class="p">{</span>
    <span class="n">drone_pitch</span> <span class="o">=</span> <span class="n">ToDeg</span><span class="p">(</span><span class="n">mavlink_msg_attitude_get_pitch</span><span class="p">(</span><span class="o">&amp;</span><span class="n">msg</span><span class="p">));</span>
    <span class="n">drone_roll</span> <span class="o">=</span> <span class="n">ToDeg</span><span class="p">(</span><span class="n">mavlink_msg_attitude_get_roll</span><span class="p">(</span><span class="o">&amp;</span><span class="n">msg</span><span class="p">));</span>
    <span class="n">drone_yaw</span> <span class="o">=</span> <span class="n">ToDeg</span><span class="p">(</span><span class="n">mavlink_msg_attitude_get_yaw</span><span class="p">(</span><span class="o">&amp;</span><span class="n">msg</span><span class="p">));</span>
<span class="p">}</span>
<span class="k">break</span><span class="p">;</span>

<span class="k">case</span> <span class="nl">MAVLINK_MSG_ID_GPS_RAW_INT</span><span class="p">:</span>
<span class="p">{</span>
    <span class="n">drone_lat</span> <span class="o">=</span> <span class="n">mavlink_msg_gps_raw_int_get_lat</span><span class="p">(</span><span class="o">&amp;</span><span class="n">msg</span><span class="p">)</span> <span class="o">/</span> <span class="mf">10000000.0f</span><span class="p">;</span>
    <span class="n">drone_lon</span> <span class="o">=</span> <span class="n">mavlink_msg_gps_raw_int_get_lon</span><span class="p">(</span><span class="o">&amp;</span><span class="n">msg</span><span class="p">)</span> <span class="o">/</span> <span class="mf">10000000.0f</span><span class="p">;</span>
    <span class="n">drone_fix_type</span> <span class="o">=</span> <span class="n">mavlink_msg_gps_raw_int_get_fix_type</span><span class="p">(</span><span class="o">&amp;</span><span class="n">msg</span><span class="p">);</span>
    <span class="n">drone_satellites_visible</span> <span class="o">=</span> <span class="n">mavlink_msg_gps_raw_int_get_satellites_visible</span><span class="p">(</span><span class="o">&amp;</span><span class="n">msg</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">break</span><span class="p">;</span>

<span class="k">case</span> <span class="nl">MAVLINK_MSG_ID_VFR_HUD</span><span class="p">:</span>
<span class="p">{</span>
    <span class="n">drone_heading</span> <span class="o">=</span> <span class="n">mavlink_msg_vfr_hud_get_heading</span><span class="p">(</span><span class="o">&amp;</span><span class="n">msg</span><span class="p">);</span> <span class="c1">// 0..360 deg, 0=north</span>
    <span class="n">drone_alt_asl</span> <span class="o">=</span> <span class="n">mavlink_msg_vfr_hud_get_alt</span><span class="p">(</span><span class="o">&amp;</span><span class="n">msg</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">break</span><span class="p">;</span>
</pre></div>
</div>
<p>That function does send attitude and GPS data to a file on the camera’s
SD card. It does call and communicate with the camera through a local
<a class="reference external" href="https://github.com/sandrobenigno/3dr-camera-ctrl/tree/master/CHDK/SCRIPTS">CHDK script</a>.</p>
<p>In order to make it work fully, the autopilot should implement
specific messages for the whole set of functions that the board will
translate into setup and triggering. You can see here the suggested
entries, though it could be expressed in many other ways on a future
implementation:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">case</span> <span class="nl">MAVLINK_MSG_ID_DIGICAM_CONTROL</span><span class="p">:</span> <span class="c1">//MAV_CMD_DO_DIGICAM_CONTROL:</span>
<span class="p">{</span>
    <span class="n">cam_ctrl_state</span><span class="p">.</span><span class="n">session</span>     <span class="o">=</span> <span class="n">mavlink_msg_digicam_control_get_session</span><span class="p">(</span><span class="o">&amp;</span><span class="n">msg</span><span class="p">);</span>
    <span class="n">cam_ctrl_state</span><span class="p">.</span><span class="n">zoom_pos</span>    <span class="o">=</span> <span class="n">mavlink_msg_digicam_control_get_zoom_pos</span><span class="p">(</span><span class="o">&amp;</span><span class="n">msg</span><span class="p">);</span>
    <span class="n">cam_ctrl_state</span><span class="p">.</span><span class="n">focus_lock</span>  <span class="o">=</span> <span class="n">mavlink_msg_digicam_control_get_focus_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">msg</span><span class="p">);</span>
    <span class="n">cam_ctrl_state</span><span class="p">.</span><span class="n">shot</span>        <span class="o">=</span> <span class="n">mavlink_msg_digicam_control_get_shot</span><span class="p">(</span><span class="o">&amp;</span><span class="n">msg</span><span class="p">);</span>
    <span class="n">cam_ctrl_state</span><span class="p">.</span><span class="n">command_id</span>  <span class="o">=</span> <span class="n">mavlink_msg_digicam_control_get_command_id</span><span class="p">(</span><span class="o">&amp;</span><span class="n">msg</span><span class="p">);</span>
    <span class="n">cam_ctrl_state</span><span class="p">.</span><span class="n">extra_param</span> <span class="o">=</span> <span class="n">mavlink_msg_digicam_control_get_extra_param</span><span class="p">(</span><span class="o">&amp;</span><span class="n">msg</span><span class="p">);</span>
    <span class="n">cam_ctrl_state</span><span class="p">.</span><span class="n">extra_value</span> <span class="o">=</span> <span class="n">mavlink_msg_digicam_control_get_extra_value</span><span class="p">(</span><span class="o">&amp;</span><span class="n">msg</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">break</span><span class="p">;</span>
</pre></div>
</div>
<p>The main control points are these ones:</p>
<ul class="simple">
<li>cam_ctrl_state.session: show’s or retract the lenses</li>
<li>cam_ctrl_state.zoom_pos: does control the focal length</li>
<li>cam_ctrl_state.focus_lock: does lock or unlock the focus</li>
<li>cam_ctrl_state.shot: does shot the camera</li>
</ul>
</div>
</div>


            
            
             
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="common-vrgimbal.html" class="btn btn-neutral float-right" title="Archived:VR Gimbal Controller (3-Axis Open Source)" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="common-qualcomm-snapdragon-flight-kit.html" class="btn btn-neutral" title="Archived: Qualcomm Snapdragon Flight Kit" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>
  
  
  Questions, issues, and suggestions about this page can be raised on the <a href="https://discuss.ardupilot.org">forums</a>. Issues and suggestions may be posted on the forums or the <a href="https://github.com/ArduPilot/ardupilot_wiki/issues/new?title=Archived:Open Camera Control Board&amp;body=[Archived:Open Camera Control Board](https://ardupilot.org/copter/docs/common-camera-control-board.html)%20-%20Describe%20the%20issue/suggestion%20and%20improve%20the%20title.%20Please%20keep%20a%20link%20to%20the%20original%20article%20if%20relevant.&amp;labels=docs">Github Issue Tracker</a>.
  <hr/>

  <div role="contentinfo">
    <p>
    <a style="float:right;" rel="license" href="https://creativecommons.org/licenses/by-sa/3.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/3.0/88x31.png" /></a>
        &copy; Copyright 2020, ArduPilot Dev Team.

    </p>
  </div>
  


</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/language_data.js"></script>
      <script type="text/javascript" src="../_static/./useralerts.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
    <script type="text/javascript" src="../_static/js/menubar.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   


<!-- Google Analytics -->
<!-- This is official ArduPilot analytics account -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  _gaq.push(['_trackPageLoadTime']);
  _gaq.push(["_setSiteSpeedSampleRate", 0]);
  ga('create', 'UA-75650032-1', 'auto');
  ga('send', 'pageview');

</script>
<!-- Google Analytics -->

</body>
</html>